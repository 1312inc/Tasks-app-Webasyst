{$wrapper_id = uniqid('t-templates-plugin-templates-header-link-wrapper')}
{if $wa->whichUi() == '1.3'}
<div class="t-templates-plugin-templates-header-link-wrapper" id="{$wrapper_id}">
    <ul class="menu-h dropdown js-dropdown-menu ">
        <li>
            <a class="t-selected-item js-dropdown-menu-title" href="javascript:void(0);"><i class="icon16 notebook"></i></a>

            <ul class="menu-v with-icons js-task-templates-menu">
                {foreach $templates as $template}
                    <li class="t-nav-item js-dropdown-menu-item">
                        <a class="js-template-header-link t-template-link" href="#" title="{$template.name|escape}" data-template="{$template.id}">
                            <i class="icon16 {$template.icon|escape} t-icon"></i><span class="t-name">{$template.name|escape}</span>
                        </a>
                    </li>
                {/foreach}
            </ul>
        </li>
    </ul>

    <script>
        (function ($) {
            var $wrapper = $("#{$wrapper_id}");
            new TasksTemplatesPluginTaskEdit({
                $wrapper: $wrapper
            });
        })(jQuery);
    </script>
</div>
{else}
<div class="t-templates-plugin-templates-header-link-wrapper" id="{$wrapper_id}" style="right: 1rem;">
    <div class="dropdown js-dropdown-menu">
        <button class="dropdown-toggle button light-gray t-selected-item js-dropdown-menu-title"><i class="fas fa-fish"></i> [`Template`]</button>
        <div class="dropdown-body right">
            <ul class="menu with-icons js-task-templates-menu">
                {foreach $templates as $template}
                    <li class="t-nav-item js-dropdown-menu-item">
                        <a class="js-template-header-link t-template-link" href="#" title="{$template.name|escape}" data-template="{$template.id}">
                            <i class="icon16 {$template.icon|escape} t-icon"></i><span class="t-name">{$template.name|escape}</span>
                        </a>
                    </li>
                {/foreach}
            </ul>
        </div>
    </div>

    <script>
        (function ($) {
            $('#{$wrapper_id} .dropdown').waDropdown({
                hover: false,
                items: ".menu > li > a",
            });

            var $wrapper = $("#{$wrapper_id}");
            new TasksTemplatesPluginTaskEdit({
                $wrapper: $wrapper
            });
        })(jQuery);
    </script>
</div>
{/if}
